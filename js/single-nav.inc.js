!function(c){"use strict";c(window).on("load",function(){var d=main_data.debug,n=nav_data.rest_url,o="&astrodj_api_key="+main_data.api_key+"&astrodj_api_secret="+main_data.api_secret;function r(){var e=c(".astrodj-post-navigation__previous"),s=e.offset().top-c(window).outerHeight();c(window).on("scroll",function(t){function a(e){var t,a,i,s,d=e.featured_media;function o(){return'<header class="entry-header"><span class="posted-on"><time class="entry-date published">'+e.astrodj_date+'</time></span><div class="entry-meta"><span class="cat-links">'+function(){for(var t=e._embedded["wp:term"][0],a=[],i=0;i<t.length;i++)a.push('<a href="'+t[i].link+'" rel="category tag">'+t[i].name+"</a>");return a.join(", ")}()+'</span></div><h2 class="entry-title"><a href="'+e.link+'" data-id="'+e.id+'" data-slug="'+e.slug+'" data-blog_page="'+e.astrodj_blog_page+'" rel="bookmark">'+e.title.rendered+"</a></h2></header>"}i='<div class="astrodj-post-navigation__load--prev"><div class="astrodj-post-navigation__previous" data-id="'+e.previous_post_ID+'"></div><div class="lds-ellipsis"><div></div><div></div><div></div><div></div></div></div>',s='<article id="post-'+e.id+'" class="astrodj-post post"><div class="post__content">'+o()+(0===d?"":(t=(d=e._embedded["wp:featuredmedia"][0]).media_details.sizes.full.width,a=d.media_details.sizes.full.height,s="vertical"===e.meta.featured_image_format_meta?" vertical":"",'<div class="post-thumbnail-header"><a href="'+e.link+'" data-id="'+e.id+'" data-blog_page="'+e.astrodj_blog_page+'"><figure class="astrodj-lqip post-thumbnail blog-thumbnail'+s+'" data-alt="'+d.alt_text+'" data-src="'+d.media_details.sizes.full.source_url+'" ><div class="aspect-ratio-fill" style="padding-bottom: 66.7%;width: 100%;height: 0;"></div><div class="astrodj-lqip__wrap"><img width="'+t+'" height="'+a+'" alt="" class="placeholder" src="'+d.media_details.sizes.astrodj_lqip.source_url+'"></div><div class="astrodj-lqip__wrap"><img width="'+t+'" height="'+a+'" class="lazy"></div></figure></a></div>'))+(""===e.excerpt.rendered?"":'<div class="entry-content">'+e.excerpt.rendered+"</div>")+"</div></article>"+i,c(".astrodj-post-navigation__load--prev").replaceWith(s),setInterval(function(){c(".astrodj-post-navigation__load--prev").prev(".astrodj-post").addClass("loaded")},150),r()}var i;s>c(window).scrollTop()||(i=(i=e).attr("data-id"),i=n+i+"?_embed=true"+o,c(".astrodj-post-navigation__load--prev .lds-ellipsis").show(),c.ajax({dataType:"json",url:i}).done(function(t){a(t),p()}).fail(function(){d&&console.log("error"),c(".astrodj-post-navigation__load--prev .lds-ellipsis").hide(),c(".astrodj-post-navigation__load--prev").replaceWith('<article class="astrodj-post-navigation__end"><p>Постов больше нет...</p></article>')}),c(this).off(t))})}function l(){var e,s,d=c(".astrodj-post-navigation__next"),o=(c("#masthead").height(),c("#site-navigation").height(),.5*d.offset().top),r=0;null!=e&&c(window).unbind("scroll",e),e=function(t){function a(e){var t,a,i,s=e.featured_media;function d(){return'<header class="entry-header"><span class="posted-on"><time class="entry-date published">'+e.astrodj_date+'</time></span><div class="entry-meta"><span class="cat-links">'+function(){for(var t=e._embedded["wp:term"][0],a=[],i=0;i<t.length;i++)a.push('<a href="'+t[i].link+'" rel="category tag">'+t[i].name+"</a>");return a.join(", ")}()+'</span></div><h2 class="entry-title"><a href="'+e.link+'" data-id="'+e.id+'" data-slug="'+e.slug+'" data-blog_page="'+e.astrodj_blog_page+'" rel="bookmark">'+e.title.rendered+"</a></h2></header>"}i='<div class="astrodj-post-navigation__load--next"><div class="lds-ellipsis"><div></div><div></div><div></div><div></div></div><div class="astrodj-post-navigation__next" data-id="'+e.next_post_ID+'"></div></div>'+'<article id="post-'+e.id+'" class="astrodj-post post"><div class="post__content">'+d()+(0===s?"":(t=(s=e._embedded["wp:featuredmedia"][0]).media_details.sizes.medium_large.width,a=s.media_details.sizes.medium_large.height,i="vertical"===e.meta.featured_image_format_meta?"vertical":"blog-thumbnail",'<div class="post-thumbnail-header"><a href="'+e.link+'" data-id="'+e.id+'" data-blog_page="'+e.astrodj_blog_page+'"><figure class="astrodj-lqip post-thumbnail blog-thumbnail '+i+'" data-alt="'+s.alt_text+'" data-src="'+s.media_details.sizes.medium_large.source_url+'" ><div class="aspect-ratio-fill" style="padding-bottom: 66.7%;width: 100%;height: 0;"></div><div class="astrodj-lqip__wrap"><img width="'+t+'" height="'+a+'" alt="" class="placeholder" src="'+s.media_details.sizes.astrodj_lqip.source_url+'"></div><div class="astrodj-lqip__wrap"><img width="'+t+'" height="'+a+'" class="lazy"></div></figure></a></div>'))+(""===e.excerpt.rendered?"":'<div class="entry-content">'+e.excerpt.rendered+"</div>")+"</div></article>",c(".astrodj-post-navigation__load--next").replaceWith(i),setInterval(function(){c(".astrodj-post-navigation__load--next").next(".astrodj-post").addClass("loaded")},150),l()}var i;s=t.currentTarget.scrollY>r?"down":"up",r=t.currentTarget.scrollY,c(window).scrollTop()<o&&"up"==s&&(t=(t=d).attr("data-id"),t=n+t+"?_embed=true",i=c("#masthead").height(),c(".astrodj-post-navigation__load--next .lds-ellipsis").show(),c.ajax({dataType:"json",url:t}).done(function(t){a(t),c(window).scrollTop(i),p()}).fail(function(){c(".astrodj-post-navigation__load--next .lds-ellipsis").hide(),c(".astrodj-post-navigation__load--next").replaceWith('<article class="astrodj-post-navigation__end"><p>Новых постов больше нет...</p></article>')}),c(window).unbind("scroll",e))},c(window).bind("scroll",e)}function p(){var s,t=[].slice.call(document.querySelectorAll(".astrodj-post-navigation img.lazy"));"IntersectionObserver"in window&&(s=new IntersectionObserver(function(t,a){t.forEach(function(t){var a,i,e;t.isIntersecting&&(t=(a=t.target).closest(".astrodj-lqip__wrap").previousElementSibling,i=t.firstElementChild,e=a.closest("figure"),t.classList.add("bg"),setTimeout(function(){i.classList.add("visible"),a.alt=e.hasAttribute("data-alt")?e.dataset.alt:"",a.src=e.dataset.src,a.srcset=e.hasAttribute("data-srcset")?e.dataset.srcset:"",a.sizes=e.hasAttribute("data-sizes")?e.dataset.sizes:"",a.addEventListener("load",function(t){t.target.classList.add("visible")}),s.unobserve(a)},300))})},{threshold:.25}),t.forEach(function(t){s.observe(t)})),c("img.lazy").each(function(t){var a=parseInt(c(this).attr("width")),i=parseInt(c(this).attr("height")),i=i<a?100/(a/i):100*(i/a);c(this).parents(".astrodj-lqip__wrap").prevAll(".aspect-ratio-fill").attr("style","padding-bottom: "+i+"%;width: 100%;")})}c(".astrodj-post-navigation.next").length&&c(window).on("scroll",function(){var t=c(window).scrollTop();t<c(".hentry").offset().top-c(".site-header").height()-c(".main-navigation").height()+4?(c(".single-post .site-header").css({position:"sticky",top:"0"}),c(".single-post .main-navigation").css({position:"sticky",top:c(".site-header").height()})):(c(".single-post .site-header").css({position:"relative",top:c(".hentry").offset().top-c(".site-header").height()-c(".main-navigation").height()}),c(".single-post .main-navigation").css({position:"relative",top:c(".hentry").offset().top-c(".site-header").height()-c(".main-navigation").height()})),t>c(".hentry").offset().top-c(".site-header").height()+8&&c(".single-post .main-navigation").css({position:"sticky",top:"0"})}),c(".astrodj-post-navigation__load--prev").length&&r(),c(".astrodj-post-navigation.next").length&&l()})}(jQuery);